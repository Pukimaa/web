---
import XElement from "astro-xelement";
---

<XElement @is="div" @do={() => {
		var isInViewport = (elem) => {
			const rect = elem.getBoundingClientRect();
      return (
          rect.top >= 0 &&
          rect.left >= 0 &&
          rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
          rect.right <= (window.innerWidth || document.documentElement.clientWidth)
      );
		}
		let observerOptions = {
    rootMargin: '0px',
    threshold: 0.5
    }
		var observer = new IntersectionObserver(observerCallback, observerOptions);
		function observerCallback(entries, observer){
			if(entries == undefined) entries = [];
			entries.forEach(entry => {
          if(entry.isIntersecting) {
            entry.target.classList.add('fade-in');
          }
      });
		}
		let target = ".card-container";
		document.querySelectorAll(target).forEach(elem => {
			if(isInViewport(elem)){ 
				elem.style.transition = 'unset';
				elem.style.opacity = 1;
			} else {
				observer.observe(elem);
			}
		})
	}}>
<slot />
</XElement>